<!DOCTYPE html>
<html lang="en-US">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta http-equiv="X-Clacks-Overhead" content="GNU Terry Pratchett" />
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="shortcut icon" href="http://localhost:1313/images/favicon.png" />
<title>Exploring Fractals | Nikola Stoyanov</title>
<meta name="title" content="Exploring Fractals" />
<meta name="description" content="I recently rewatched a video from Arthur C. Clarke which is where I first saw what fractals are. I saw this video while I was in high school and having rewatched it now I wondered if I can generate the Mandelbrot set and explore some parts of it myself. I did a quick search online and I discovered that Jean Francois Puget had already done that and achieved great results. Learning from his work I decided to do some computational experiments." />
<meta name="keywords" content="Python,Scipy,Numerical Analysis,Scientific Computing," />


<meta property="og:url" content="http://localhost:1313/exploring-fractals/">
  <meta property="og:site_name" content="Nikola Stoyanov">
  <meta property="og:title" content="Exploring Fractals">
  <meta property="og:description" content="I recently rewatched a video from Arthur C. Clarke which is where I first saw what fractals are. I saw this video while I was in high school and having rewatched it now I wondered if I can generate the Mandelbrot set and explore some parts of it myself. I did a quick search online and I discovered that Jean Francois Puget had already done that and achieved great results. Learning from his work I decided to do some computational experiments.">
  <meta property="og:locale" content="en_US">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2018-08-02T00:00:00+00:00">
    <meta property="article:modified_time" content="2018-08-02T00:00:00+00:00">
    <meta property="article:tag" content="Python">
    <meta property="article:tag" content="Scipy">
    <meta property="article:tag" content="Numerical Analysis">
    <meta property="article:tag" content="Scientific Computing">
    <meta property="og:image" content="http://localhost:1313/images/share.png">




  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/images/share.png">
  <meta name="twitter:title" content="Exploring Fractals">
  <meta name="twitter:description" content="I recently rewatched a video from Arthur C. Clarke which is where I first saw what fractals are. I saw this video while I was in high school and having rewatched it now I wondered if I can generate the Mandelbrot set and explore some parts of it myself. I did a quick search online and I discovered that Jean Francois Puget had already done that and achieved great results. Learning from his work I decided to do some computational experiments.">




  <meta itemprop="name" content="Exploring Fractals">
  <meta itemprop="description" content="I recently rewatched a video from Arthur C. Clarke which is where I first saw what fractals are. I saw this video while I was in high school and having rewatched it now I wondered if I can generate the Mandelbrot set and explore some parts of it myself. I did a quick search online and I discovered that Jean Francois Puget had already done that and achieved great results. Learning from his work I decided to do some computational experiments.">
  <meta itemprop="datePublished" content="2018-08-02T00:00:00+00:00">
  <meta itemprop="dateModified" content="2018-08-02T00:00:00+00:00">
  <meta itemprop="wordCount" content="1664">
  <meta itemprop="image" content="http://localhost:1313/images/share.png">
  <meta itemprop="keywords" content="Python,Scipy,Numerical Analysis,Scientific Computing">
<meta name="referrer" content="no-referrer-when-downgrade" />

  <style>
  body {
    font-family: Verdana, sans-serif;
    margin: auto;
    padding: 20px;
    max-width: 720px;
    text-align: left;
    background-color: #fff;
    word-wrap: break-word;
    overflow-wrap: break-word;
    line-height: 1.5;
    color: #444;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  strong,
  b {
    color: #222;
  }

  a {
    color: #3273dc;
     
  }

  .title {
    text-decoration: none;
    border: 0;
  }

  .title span {
    font-weight: 400;
  }

  nav a {
    margin-right: 10px;
  }

  textarea {
    width: 100%;
    font-size: 16px;
  }

  input {
    font-size: 16px;
  }

  content {
    line-height: 1.6;
  }

  table {
    width: 100%;
  }

  img {
    max-width: 100%;
  }

  code {
    padding: 2px 5px;
    background-color: #f2f2f2;
  }

  pre code {
    color: #222;
    display: block;
    padding: 20px;
    white-space: pre-wrap;
    font-size: 14px;
    overflow-x: auto;
  }

  div.highlight pre {
    background-color: initial;
    color: initial;
  }

  div.highlight code {
    background-color: unset;
    color: unset;
  }

  blockquote {
    border-left: 1px solid #999;
    color: #222;
    padding-left: 20px;
    font-style: italic;
  }

  footer {
    padding: 25px;
    text-align: center;
  }

  .helptext {
    color: #777;
    font-size: small;
  }

  .errorlist {
    color: #eba613;
    font-size: small;
  }

   
  ul.blog-posts {
    list-style-type: none;
    padding: unset;
  }

  ul.blog-posts li {
    display: flex;
  }

  ul.blog-posts li span {
    flex: 0 0 130px;
  }

  ul.blog-posts li a:visited {
    color: #8b6fcb;
  }

  @media (prefers-color-scheme: dark) {
    body {
      background-color: #333;
      color: #ddd;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6,
    strong,
    b {
      color: #eee;
    }

    a {
      color: #8cc2dd;
    }

    code {
      background-color: #777;
    }

    pre code {
      color: #ddd;
    }

    blockquote {
      color: #ccc;
    }

    textarea,
    input {
      background-color: #252525;
      color: #ddd;
    }

    .helptext {
      color: #aaa;
    }
  }

</style>
<style>
    body {
      font-family: Verdana, sans-serif;
      margin: auto;
      padding: 20px;
      max-width: 720px;
      text-align: left;
      background-color: #fff;
      word-wrap: break-word;
      overflow-wrap: break-word;
      line-height: 1.5;
      color: #ffffff;
    }
  
    h1,
    h2,
    h3,
    h4,
    h5,
    h6,
    strong,
    b {
      color: #000000;
    }
  
    a {
      color: #3273dc;
       
    }
  
    .title {
      text-decoration: none;
      border: 0;
    }
  
    .title span {
      font-weight: 400;
    }
  
    nav a {
      margin-right: 10px;
    }
  
    textarea {
      width: 100%;
      font-size: 16px;
    }
  
    input {
      font-size: 16px;
    }
  
    content {
      line-height: 1.6;
    }
  
    table {
      width: 100%;
    }
  
    img {
      max-width: 100%;
    }
  
    code {
      padding: 2px 5px;
      background-color: #9c9c9c;
    }
  
    pre code {
      color: #222;
      display: block;
      padding: 20px;
      white-space: pre-wrap;
      font-size: 14px;
      overflow-x: auto;
    }
  
    div.highlight pre {
      background-color: initial;
      color: initial;
    }
  
    div.highlight code {
      background-color: unset;
      color: unset;
    }
  
    blockquote {
      border-left: 1px solid #999;
      color: #222;
      padding-left: 20px;
      font-style: italic;
    }
  
    footer {
      padding: 25px;
      text-align: center;
    }
  
    .helptext {
      color: #777;
      font-size: small;
    }
  
    .errorlist {
      color: #eba613;
      font-size: small;
    }
  
     
    ul.blog-posts {
      list-style-type: none;
      padding: unset;
    }
  
    ul.blog-posts li {
      display: flex;
    }
  
    ul.blog-posts li span {
      flex: 0 0 130px;
    }
  
    ul.blog-posts li a:visited {
      color: #8b6fcb;
    }
  
    @media (prefers-color-scheme: dark) {
      body {
        background-color: #ffffff;
        color: #000000;
      }
  
      h1,
      h2,
      h3,
      h4,
      h5,
      h6,
      strong,
      b {
        color: #000000;
      }
  
      a {
        color: #8cc2dd;
      }
  
      code {
        background-color: #777;
      }
  
      pre code {
        color: #ddd;
      }
  
      blockquote {
        color: #ccc;
      }
  
      textarea,
      input {
        background-color: #252525;
        color: #ddd;
      }
  
      .helptext {
        color: #aaa;
      }
    }
  
  </style>
  
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script>
	  MathJax = {
		      tex: {
			            displayMath: [['\\[', '\\]'], ['$$', '$$']],  
			            inlineMath: [['\\(', '\\)'], ['$', '$']]      
			          },
		      loader:{
			            load: ['ui/safe']
			          },
		    };
</script>

  
</head>

<body>
  <header><a href="/" class="title">
  <h2>Nikola Stoyanov</h2>
</a>
<nav><a href="/">Home</a>

<a href="/bear/">Bear</a>


<a href="/blog">Blog</a>

</nav>
</header>
  <main>

<h1>Exploring Fractals</h1>
<p>
  <i>
    <time datetime='2018-08-02' pubdate>
      02 Aug, 2018
    </time>
  </i>
</p>

<content>
  <p>I recently rewatched a <a href="https://www.youtube.com/watch?v=Lk6QU94xAb8">video</a> from Arthur C. Clarke which is where I
first saw what fractals are. I saw this video while I was in high
school and having rewatched it now I wondered if I can generate the
Mandelbrot set and explore some parts of it myself. I did a quick
search online and I discovered that <a href="https://www.ibm.com/developerworks/community/blogs/jfp/entry/My_Christmas_Gift?lang=en">Jean Francois Puget</a> had already
done that and achieved great results. Learning from his work I decided
to do some computational experiments.</p>
<p>For this post I will use the acceleration provided by <em>numba</em> as in the
original post by <a href="https://www.ibm.com/developerworks/community/blogs/jfp/entry/My_Christmas_Gift?lang=en">Jean Francois Puget</a>. In a further post he developed a
parallel version of the code so you can check it out, but for my
purposes now <em>numba</em> will be enough.</p>
<h1 id="fractals">Fractals</h1>
<p>Fractals are abstract objects that are infinitely complicated and
exhibit similar patterns at increasingly smaller scales. What this
means is that we can keep zooming in the fractal until the original
picture is bigger than the visible universe and still see
patterns. For this post I want to explore the Mandelbrot set and
produce the fractal from it. However, before delving in the Mandelbrot
set we need to look at the more general picture.</p>
<p>The Mandelbrot set is made by iteration using the simple formula
</p>
$$z_{n+1} = z_n^2 + c$$<p> for different values of $c$ in the complex
plane. Then we have two possible paths: the iteration will converge or
diverge. Points on the complex plane $\mathbb{C}$ for which $z_n$ is
bounded form the Mandelbrot set. Points which are not bounded do not
belong to the Mandelbrot set and to get artistic pictures are usually
coloured based on how fast they change. Each point $c$ then specifies
the geometric structure of the corresponding Julia set.</p>
<p>Julia sets are formed by performing a repeated iteration of a
holomorphic function and in this post we will investigate polynomial
functions of the form $z_{n+1} = z_{n}^2 + c$. The set has an
interesting property of chaotic behaviour which produces drastically
different result from a small perturbation. The Julia set also has a
complementary set known as the Fatou set which has the property that
all values behave similarly under the repeated iteration. Now if a
point $c$ is in the Mandelbrot set the Julia set is called connected,
if it is not then it is known as Cantor/Fatou dust.</p>
<p>We can now visualise what we mean by the above by using some Python
code and the Scipy library.</p>
<h1 id="mandelbrot-set">Mandelbrot Set</h1>
<p>The Mandelbrot set is generated using the iterative formula below.</p>
$$z_{n+1} = z_{n}^{2} + c$$<p>To get the set we start from $z_{0} = 0$ for a given $c$
coordinate. Expressing it mathematically, for a point to belong to the
Mandelbrot set we need the limit to be $\leq 2$. The precise reason is
given below.</p>
$$c \in M \iff \lim_{n \to \infty} \sup|z_{n+1}| \leq 2$$<p>When I first saw the mathematical description I could not understand
why was the number 2 written as the upper boundary to determine if a
point belongs to the Mandelbrot set or not. I decided to dig further
and I found the mathematical proof. I found the explanation in <a href="http://www.alunw.freeuk.com/mandelbrotroom.html">Alun
Williams&rsquo;</a> website and you can read it there.</p>
<p>Lets define the function for the Mandelbrot set.</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> numba <span style="color:#f92672">import</span> jit
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@jit</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">mandelbrot</span>(c, maxiter):
</span></span><span style="display:flex;"><span>    z <span style="color:#f92672">=</span> c
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> n <span style="color:#f92672">in</span> range(maxiter):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> abs(z) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">2</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> n
</span></span><span style="display:flex;"><span>        z <span style="color:#f92672">=</span> z<span style="color:#f92672">*</span>z <span style="color:#f92672">+</span> c
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
</span></span></code></pre></div><p>The holomorphic function can then be called to generate the Mandelbrot
set. I will take this opportunity to generalise the set generation and
plot functions so we can use them with the Julia set as well.</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#a6e22e">@jit</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">generate_set</span>(set_function, xmin, xmax, ymin, ymax, width, height, maxiter):
</span></span><span style="display:flex;"><span>    r1 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(xmin, xmax, width)
</span></span><span style="display:flex;"><span>    r2 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(ymin, ymax, height)
</span></span><span style="display:flex;"><span>    n3 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>empty((width,height))
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(width):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(height):
</span></span><span style="display:flex;"><span>            n3[i, j] <span style="color:#f92672">=</span> set_function(r1[i] <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>j <span style="color:#f92672">*</span> r2[j], maxiter)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> (r1, r2, n3)
</span></span></code></pre></div><p>Having generated the set we need a way to visualise it. We can do this
with Matplotlib. As states above the algorithm to display the fractals
is explained <a href="https://www.ibm.com/developerworks/community/blogs/jfp/entry/My_Christmas_Gift?lang=en">here</a>.</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> matplotlib <span style="color:#f92672">import</span> pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> matplotlib <span style="color:#f92672">import</span> colors
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> matplotlib <span style="color:#f92672">import</span> patches
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> IPython.display <span style="color:#f92672">import</span> set_matplotlib_formats
</span></span><span style="display:flex;"><span><span style="color:#f92672">%</span>matplotlib inline
</span></span><span style="display:flex;"><span>set_matplotlib_formats(<span style="color:#e6db74">&#39;png&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">generate_image</span>(set_function, xmin, xmax, ymin, ymax, width<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, height<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, maxiter<span style="color:#f92672">=</span><span style="color:#ae81ff">256</span>):
</span></span><span style="display:flex;"><span>    dpi <span style="color:#f92672">=</span> <span style="color:#ae81ff">72</span>
</span></span><span style="display:flex;"><span>    img_width <span style="color:#f92672">=</span> dpi <span style="color:#f92672">*</span> width
</span></span><span style="display:flex;"><span>    img_height <span style="color:#f92672">=</span> dpi <span style="color:#f92672">*</span> height
</span></span><span style="display:flex;"><span>    x,y,z <span style="color:#f92672">=</span> generate_set(set_function, xmin, xmax, ymin, ymax, img_width, img_height, maxiter)
</span></span><span style="display:flex;"><span>                    
</span></span><span style="display:flex;"><span>    fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(figsize<span style="color:#f92672">=</span>(width, height), dpi<span style="color:#f92672">=</span><span style="color:#ae81ff">72</span>)
</span></span><span style="display:flex;"><span>    ticks <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">0</span>, img_width, <span style="color:#ae81ff">3</span><span style="color:#f92672">*</span>dpi)
</span></span><span style="display:flex;"><span>    x_ticks <span style="color:#f92672">=</span> xmin <span style="color:#f92672">+</span> (xmax<span style="color:#f92672">-</span>xmin)<span style="color:#f92672">*</span>ticks<span style="color:#f92672">/</span>img_width
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>xticks(ticks, x_ticks)
</span></span><span style="display:flex;"><span>    y_ticks <span style="color:#f92672">=</span> ymin <span style="color:#f92672">+</span> (ymax<span style="color:#f92672">-</span>ymin)<span style="color:#f92672">*</span>ticks<span style="color:#f92672">/</span>img_width
</span></span><span style="display:flex;"><span>    plt<span style="color:#f92672">.</span>yticks(ticks, y_ticks)
</span></span><span style="display:flex;"><span>                                                
</span></span><span style="display:flex;"><span>    ax<span style="color:#f92672">.</span>imshow(z<span style="color:#f92672">.</span>T, origin<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;lower&#39;</span>)
</span></span></code></pre></div><p>We can then visualise the Mandelbrot set.</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>generate_image(mandelbrot, <span style="color:#f92672">-</span><span style="color:#ae81ff">2.0</span>, <span style="color:#ae81ff">0.5</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1.25</span>, <span style="color:#ae81ff">1.25</span>)
</span></span></code></pre></div><!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><img src="/images/2018-08-02-exploring-fractals/exploring-fractals_20_0.png" alt="png"></p>
<!-- raw HTML omitted -->
<p>The &ldquo;main&rdquo; part of the Mandelbrot is called the main cardioid and the
set contains small copies of itself connected to the main
cardioid. This continues and we get structures which resemble hairs,
not surprisingly these features are called Mandelbrot hair.</p>
<p>Other explorers have discovered interesting anchor points. For example
lets set sail to $-0.761574-i0.0847596$ as shown on maps generated by
<a href="http://paulbourke.net/fractals/mandelbrot/">Paul Bourke</a>. We will centre at this point and zoom $\times 10$ to
start with. Note that the original generated image is of size
$2.5\times2.5$ and we need a function to generate the size of the
image for the given zoom.</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">zoom_image</span>(xc, yc, size):
</span></span><span style="display:flex;"><span>    x1 <span style="color:#f92672">=</span> xc <span style="color:#f92672">-</span> size
</span></span><span style="display:flex;"><span>    x2 <span style="color:#f92672">=</span> xc <span style="color:#f92672">+</span> size
</span></span><span style="display:flex;"><span>    y1 <span style="color:#f92672">=</span> yc <span style="color:#f92672">-</span> size
</span></span><span style="display:flex;"><span>    y2 <span style="color:#f92672">=</span> yc <span style="color:#f92672">+</span> size
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> x1, x2, y1, y2
</span></span></code></pre></div><p>We can than choose our point of interest and zoom into it.</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>xc <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.761574</span>
</span></span><span style="display:flex;"><span>yc <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0.0847596</span>
</span></span><span style="display:flex;"><span>size <span style="color:#f92672">=</span> <span style="color:#ae81ff">2.5</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>x1, x2, y1, y2 <span style="color:#f92672">=</span> zoom_image(xc, yc, size)
</span></span><span style="display:flex;"><span>generate_image(mandelbrot, x1, x2, y1, y2)
</span></span></code></pre></div><!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><img src="/images/2018-08-02-exploring-fractals/exploring-fractals_24_0.png" alt="png"></p>
<!-- raw HTML omitted -->
<p>Great, everything is looking fine. We can see the primary continental
mu-atom and a mu-atom of period 2, if you want an explanation of the
names go <a href="https://www.mrob.com/pub/muency/r2.html">here</a>. The place in the middle where all the interesting
features occur is know as the <a href="https://www.mrob.com/pub/muency/seahorsevalley.html">seahorse valley</a> and we are going to
explore the southern part. Lets zoom $\times 500$ and explore the
seahorses.</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>size <span style="color:#f92672">=</span> <span style="color:#ae81ff">2.5</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">500</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>x1, x2, y1, y2 <span style="color:#f92672">=</span> zoom_image(xc, yc, size)
</span></span><span style="display:flex;"><span>generate_image(mandelbrot, x1, x2, y1, y2)
</span></span></code></pre></div><!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><img src="/images/2018-08-02-exploring-fractals/exploring-fractals_26_0.png" alt="png"></p>
<!-- raw HTML omitted -->
<p>We can see why mathematicians are referring to these patters as
seahorses. Also notice that more patterns are starting to emerge as we
go deeper in the set. Why stop now, $\times 1000$ it is.</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>size <span style="color:#f92672">=</span> <span style="color:#ae81ff">2.5</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">1000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>x1, x2, y1, y2 <span style="color:#f92672">=</span> zoom_image(xc, yc, size)
</span></span><span style="display:flex;"><span>generate_image(mandelbrot, x1, x2, y1, y2)
</span></span></code></pre></div><!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><img src="/images/2018-08-02-exploring-fractals/exploring-fractals_28_0.png" alt="png"></p>
<!-- raw HTML omitted -->
<p>I will test the ability of our code to cope with even more decimals
places and zoom to $\times 15625$. We can then compare with the image
obtained from <a href="http://paulbourke.net/fractals/mandelbrot/">Paul Bourke</a>.</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>size <span style="color:#f92672">=</span> <span style="color:#ae81ff">2.5</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">15625</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>x1, x2, y1, y2 <span style="color:#f92672">=</span> zoom_image(xc, yc, size)
</span></span><span style="display:flex;"><span>generate_image(mandelbrot, x1, x2, y1, y2)
</span></span></code></pre></div><!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><img src="/images/2018-08-02-exploring-fractals/exploring-fractals_30_0.png" alt="png"></p>
<!-- raw HTML omitted -->
<p>Okay, lets go wild and do a $5\times10^6$ zoom.</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>size <span style="color:#f92672">=</span> <span style="color:#ae81ff">2.5</span> <span style="color:#f92672">/</span> (<span style="color:#ae81ff">5</span> <span style="color:#f92672">*</span> (<span style="color:#ae81ff">10</span><span style="color:#f92672">**</span><span style="color:#ae81ff">6</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>x1, x2, y1, y2 <span style="color:#f92672">=</span> zoom_image(xc, yc, size)
</span></span><span style="display:flex;"><span>generate_image(mandelbrot, x1, x2, y1, y2)
</span></span></code></pre></div><!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><img src="/images/2018-08-02-exploring-fractals/exploring-fractals_32_0.png" alt="png"></p>
<!-- raw HTML omitted -->
<p>Whoops, it seems that we have reached the limit of the colouring
algorithm. This is an issue for another post, where I am planning to
program the problem in C++ and use different generation and colouring
algorithms.</p>
<h1 id="julia-set">Julia Set</h1>
<p>To generate a Julia set we need a <a href="https://en.wikipedia.org/wiki/Holomorphic_function">holomorphic function</a>. In other words
we need a continuously differentiable complex-valued function with one
or more complex variable. Lets start with something random&hellip; the
first thing that comes to mind.</p>
$$f(z) = z^3 + c$$<p>The iteration is then performed for:</p>
$$z_{n+1} = z_{n}^{3} + c$$<p>We can then get the points that tend to infinity, those that do not
(Fatou set) and the boundary between them (Julia set) for a complex
number $k$ if we set $c=k$ and start with $z_{0}$ as the coordinates
of a point. Lets explore $c = -0.1 + i0.65$ which is in the Mandelbrot
set and we would get a connected Julia set. The way I have implemented this is to define a holomorphic function
with a given complex parameter $c$, the seemingly weird use of $c$ as
an argument to define $z$ and then be redefined is just for
convenience so I can use the same set generation function as for the
Mandelbrot set.</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#a6e22e">@jit</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">holomorphic_julia</span>(c, maxiter):
</span></span><span style="display:flex;"><span>    z <span style="color:#f92672">=</span> c
</span></span><span style="display:flex;"><span>    c <span style="color:#f92672">=</span> complex(<span style="color:#f92672">-</span><span style="color:#ae81ff">0.1</span>, <span style="color:#ae81ff">0.65</span>)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> n <span style="color:#f92672">in</span> range(maxiter):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> abs(z) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">10</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> n
</span></span><span style="display:flex;"><span>        z <span style="color:#f92672">=</span> z<span style="color:#f92672">*</span>z <span style="color:#f92672">+</span> c
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
</span></span></code></pre></div><p>We can then show our results and we get a weird looking bulge.</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>generate_image(holomorphic_julia, <span style="color:#f92672">-</span><span style="color:#ae81ff">1.5</span>, <span style="color:#ae81ff">1.5</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1.5</span>, <span style="color:#ae81ff">1.5</span>)
</span></span></code></pre></div><!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><img src="/images/2018-08-02-exploring-fractals/exploring-fractals_42_0.png" alt="png"></p>
<!-- raw HTML omitted -->
<p>Lets examine the fractal nature of this thing we have produced. We
would focus in the middle of our bulge.</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>xc <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.0</span>
</span></span><span style="display:flex;"><span>yc <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.0</span>
</span></span><span style="display:flex;"><span>size <span style="color:#f92672">=</span> <span style="color:#ae81ff">3.0</span> <span style="color:#f92672">/</span> <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>x1, x2, y1, y2 <span style="color:#f92672">=</span> zoom_image(xc, yc, size)
</span></span><span style="display:flex;"><span>generate_image(holomorphic_julia, x1, x2, y1, y2)
</span></span></code></pre></div><!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><img src="/images/2018-08-02-exploring-fractals/exploring-fractals_44_0.png" alt="png"></p>
<!-- raw HTML omitted -->
<p>We can see that we have generated a fractal since zooming in reveals
similar patterns of infinity complexity. We can also see the Julia
set as the boundary between the Fatou sets.</p>
<p>Now we can pick a point which is outside of the Mandelbrot set. Such a
point is $c = -2.5 - i2.5$.</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#a6e22e">@jit</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">holomorphic_candor_dust</span>(c, maxiter):
</span></span><span style="display:flex;"><span>    z <span style="color:#f92672">=</span> c
</span></span><span style="display:flex;"><span>    c <span style="color:#f92672">=</span> complex(<span style="color:#f92672">-</span><span style="color:#ae81ff">2.5</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">2.5</span>)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> n <span style="color:#f92672">in</span> range(maxiter):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> abs(z) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">10</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> n
</span></span><span style="display:flex;"><span>        z <span style="color:#f92672">=</span> z<span style="color:#f92672">*</span>z <span style="color:#f92672">+</span> c
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>generate_image(holomorphic_candor_dust, <span style="color:#f92672">-</span><span style="color:#ae81ff">4.0</span>, <span style="color:#ae81ff">4.0</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">4.0</span>, <span style="color:#ae81ff">4.0</span>)
</span></span></code></pre></div><!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><img src="/images/2018-08-02-exploring-fractals/exploring-fractals_46_0.png" alt="png"></p>
<!-- raw HTML omitted -->
<p>This is known as Cantor/Fatou dust and the calculation oscillates
between the points on the plot which is very different from the
previous Julia set. As can be seen the resultant behaviour is very
much dependent on whether $c$ is in the Mandelbrot set or not.  We can
also investigate different complex parameters. For example lets see a
$c = -0.78 + 0.1i$ which is in the Mandelbrot set and the function
$z_{n+1} = z_{n}^{2} + c$ as shown <a href="https://ibmathsresources.com/2015/03/29/mandelbrot-and-julia-sets-pictures-of-infinity/">here</a>.</p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#a6e22e">@jit</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">holomorphic_julia_spinning_eyes</span>(c, maxiter):
</span></span><span style="display:flex;"><span>    z <span style="color:#f92672">=</span> c
</span></span><span style="display:flex;"><span>    c <span style="color:#f92672">=</span> complex(<span style="color:#f92672">-</span><span style="color:#ae81ff">0.78</span>, <span style="color:#ae81ff">0.1</span>)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> n <span style="color:#f92672">in</span> range(maxiter):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> abs(z) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">10</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> n
</span></span><span style="display:flex;"><span>        z <span style="color:#f92672">=</span> z<span style="color:#f92672">*</span>z <span style="color:#f92672">+</span> c
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>generate_image(holomorphic_julia_spinning_eyes,  <span style="color:#f92672">-</span><span style="color:#ae81ff">1.5</span>, <span style="color:#ae81ff">1.5</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1.5</span>, <span style="color:#ae81ff">1.5</span>)
</span></span></code></pre></div><!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<p><img src="/images/2018-08-02-exploring-fractals/exploring-fractals_48_0.png" alt="png"></p>
<!-- raw HTML omitted -->
<p>Thank you for reading!!! I hope this was a fun post.</p>

</content>
<p>
  
  <a href="http://localhost:1313/blog/python/">#Python</a>
  
  <a href="http://localhost:1313/blog/scipy/">#Scipy</a>
  
  <a href="http://localhost:1313/blog/numerical-analysis/">#Numerical Analysis</a>
  
  <a href="http://localhost:1313/blog/scientific-computing/">#Scientific Computing</a>
  
</p>

  </main>
  <footer>Made with <a href="https://github.com/janraasch/hugo-bearblog/">Hugo ʕ•ᴥ•ʔ Bear</a>
</footer>

    
</body>

</html>
